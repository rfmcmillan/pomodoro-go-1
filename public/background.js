(()=>{"use strict";const{storage:e,tabs:t,runtime:o,alarms:s}=chrome;let r,i;chrome.action.onClicked.addListener((e=>{t.create({url:"index.html"})})),{active:!1,sessionTime:0,init:async function(){try{this.active||(s.clearAll((()=>{console.log("alarms are cleared")})),this.listenForAlarm(),this.active=!0)}catch(e){console.log("issue with start up in background js",e)}},listenForAlarm:function(){return s.onAlarm.addListener((function(t){"startTimer"===t.name&&(chrome.notifications.create(void 0,{type:"basic",title:"Your focus session is complete!",message:"Nice job! You deserve a break!",iconUrl:"logo-pomo.png",requireInteraction:!0,silent:!1},(()=>{console.log("last error: ",o.lastError)})),e.local.set({alarmCreated:!1,currentSession:{},timerOn:!1,sessionTime:0,sessionComplete:!0}))}))}}.init(),t.onUpdated.addListener((function(e,o){o.url&&new Promise((e=>{chrome.storage.local.get(["blackList"],(t=>{e(t.blackList)}))})).then((s=>{if(s)for(let r=0;r<s.length;r++)o.url.includes(s[r])&&s[r].length&&t.update(e,{url:"https://pomodoro-go-1.herokuapp.com/blocked"})}))})),chrome.runtime.onMessage.addListener(((e,t,o)=>{console.log("request:",e),"START_TIMER"===e.cmd?(console.log("request.cmd === START_TIMER"),i=new Date(e.when),r=setTimeout((()=>{console.log("timer is finished"),chrome.alarms.create("startTimer",{when:Date.now()}),i=0}),i.getTime()-Date.now())):"GET_TIME"===e.cmd&&o({time:i})}))})();
//# sourceMappingURL=background.js.map